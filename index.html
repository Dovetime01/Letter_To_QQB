<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>To My lovely QQB</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@600&family=Noto+Serif+SC:wght@400;700&family=Playfair+Display:ital,wght@0,400;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ================= æ ¸å¿ƒå˜é‡ ================= */
        :root {
            --envelope-color: #f3e5d8;
            --envelope-shadow: rgba(0,0,0,0.2);
            --seal-color: #c0392b;
            --jukebox-base: #2c3e50;
            --vinyl-color: #1a1a1a;
            --highlight-color: #e74c3c;
            --metal-color: #bdc3c7;
        }
        
        * { box-sizing: border-box; }
        
        body {
            margin: 0; padding: 0; height: 100vh;
            display: flex; justify-content: center; align-items: center;
            font-family: 'Noto Serif SC', serif;
            background-color: #1a1a1a;
            overflow: hidden;
            perspective: 1200px;
        }

        /* èƒŒæ™¯è½®æ’­ */
        .bg-slideshow { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        .bg-slide { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-size: cover; background-position: center; opacity: 0; transition: opacity 2s ease-in-out; }
        .bg-slide.active { opacity: 0.4; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.8) 100%); z-index: -1; }

        /* ================= 1. ä¿¡å°åœºæ™¯ ================= */
        .scene {
            position: relative; width: 600px; height: 400px;
            transform-style: preserve-3d;
            transition: transform 1s cubic-bezier(0.645, 0.045, 0.355, 1);
            cursor: pointer;
            z-index: 10;
        }
        .scene.flipped { transform: rotateY(180deg); }
        .scene.open { animation: fadeOutEnvelope 0.8s forwards; pointer-events: none; }
        @keyframes fadeOutEnvelope {
            0% { transform: rotateY(180deg) scale(1); opacity: 1; }
            100% { transform: rotateY(180deg) scale(0.8); opacity: 0; }
        }
        @media (max-width: 650px) {
            .scene { transform: scale(0.6); }
            .scene.flipped { transform: scale(0.6) rotateY(180deg); }
        }

        /* ä¿¡å°æ ·å¼ */
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 5px; background-color: var(--envelope-color); background-image: url("https://www.transparenttextures.com/patterns/cream-paper.png"); box-shadow: 0 15px 35px rgba(0,0,0,0.3); }
        .front { z-index: 2; transform: rotateY(0deg); border: 2px solid #e0d0c0; padding: 30px; overflow: hidden; }
        .air-mail-border { position: absolute; top: 0; left: 0; right: 0; bottom: 0; border: 10px solid transparent; background: linear-gradient(135deg, #c0392b 25%, transparent 25%, transparent 50%, #2980b9 50%, #2980b9 75%, transparent 75%, transparent); background-size: 40px 40px; opacity: 0.7; pointer-events: none; }
        .front-content { position: relative; z-index: 2; height: 100%; background: var(--envelope-color); margin: 10px; padding: 20px; box-shadow: inset 0 0 20px rgba(0,0,0,0.05); }
        .stamp { position: absolute; top: 20px; right: 20px; width: 80px; height: 95px; background: #fff; border: 1px solid #ddd; padding: 3px; box-shadow: 1px 1px 3px rgba(0,0,0,0.2); overflow: hidden; z-index: 10; }
        .stamp img { width: 100%; height: 100%; object-fit: cover; }
        .postmark { position: absolute; top: 25px; right: 85px; width: 100px; height: 100px; border: 2px solid rgba(50, 50, 50, 0.6); border-radius: 50%; color: rgba(50, 50, 50, 0.6); display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; transform: rotate(-15deg); opacity: 0.8; pointer-events: none; z-index: 10; }
        .address-from { position: absolute; top: 20px; left: 20px; font-family: 'Noto Serif SC', serif; font-size: 12px; color: #7f8c8d; line-height: 1.5; text-align: left; z-index: 10; }
        .address-to { position: absolute; bottom: 40px; right: 150px; width: 60%; font-family: 'Dancing Script', cursive; font-size: 22px; color: #2c3e50; line-height: 1.4; text-align: left; transform: rotate(-1deg); z-index: 10; }
        .label-to { font-family: 'Courier New', monospace; font-size: 12px; color: #95a5a6; letter-spacing: 2px; margin-bottom: 5px; display: block; }
        .back { transform: rotateY(180deg); z-index: 1; background: #e6d0bf; }
        .back .letter-preview { position: absolute; bottom: 0; left: 5%; width: 90%; height: 90%; background: #fffaf0; z-index: 2; transform: scale(0.95); box-shadow: 0 -2px 5px rgba(0,0,0,0.05); border-radius: 2px; }
        .flap-left { position: absolute; top: 0; left: 0; width: 0; height: 0; border-top: 200px solid transparent; border-bottom: 200px solid #e0d0c0; border-left: 300px solid #e0d0c0; z-index: 3; }
        .flap-right { position: absolute; top: 0; right: 0; width: 0; height: 0; border-top: 200px solid transparent; border-bottom: 200px solid #dcbfa8; border-right: 300px solid #dcbfa8; z-index: 3; }
        .flap-bottom { position: absolute; bottom: 0; left: 0; width: 100%; height: 0; border-left: 300px solid transparent; border-right: 300px solid transparent; border-bottom: 210px solid #d6b89f; z-index: 4; }
        .flap-top { position: absolute; top: 0; left: 0; width: 100%; height: 0; border-left: 300px solid transparent; border-right: 300px solid transparent; border-top: 220px solid #c8a88d; z-index: 6; transform-origin: top; transition: transform 0.8s ease, z-index 0.8s; }
        .scene.open .flap-top { transform: rotateX(180deg); z-index: 1; }
        .seal { position: absolute; top: 190px; left: 50%; transform: translateX(-50%); width: 55px; height: 55px; background: radial-gradient(circle at 30% 30%, #e74c3c, #922b21); border-radius: 50%; z-index: 7; box-shadow: 2px 4px 6px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; color: #722018; font-weight: bold; font-family: 'Dancing Script', cursive; font-size: 24px; cursor: pointer; border: 2px solid rgba(255,255,255,0.1); transition: transform 0.2s, opacity 0.5s; }
        .seal:hover { transform: translateX(-50%) scale(1.1); }
        .scene.open .seal { opacity: 0; pointer-events: none; }
        .timer-tip { position: absolute; bottom: -50px; left: 0; width: 100%; text-align: center; color: rgba(255,255,255,0.7); font-size: 14px; pointer-events: none; text-shadow: 0 2px 4px rgba(0,0,0,0.8); transform: rotateY(180deg); transition: opacity 0.3s; }
        .scene.flipped .timer-tip { opacity: 0; }
        .flip-hint { position: absolute; bottom: 10px; width: 100%; text-align: center; font-size: 12px; color: #999; animation: pulse 2s infinite; }
        @keyframes pulse { 0% {opacity:0.5;} 50% {opacity:1;} 100% {opacity:0.5;} }
        @keyframes shake { 0%, 100% { transform: rotateY(180deg) translateX(0); } 25% { transform: rotateY(180deg) translateX(-10px); } 75% { transform: rotateY(180deg) translateX(10px); } }

        /* ================= 2. é˜…è¯»è§†å›¾ ================= */
        .reading-view-wrapper {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            display: flex; align-items: center; justify-content: center;
            gap: 0px;
            opacity: 0; pointer-events: none;
            transition: opacity 1s 0.8s, gap 0.8s ease;
            z-index: 20; width: auto;
        }
        .scene.reading ~ .reading-view-wrapper { opacity: 1; pointer-events: auto; }
        .reading-view-wrapper.show-jukebox { gap: 50px; }

        /* --- ä¿¡çº¸ --- */
        .letter-content {
            width: 450px; height: 600px;
            background: #fffbf2; box-shadow: 0 10px 50px rgba(0,0,0,0.5); 
            padding: 40px; border-radius: 5px; position: relative; overflow: hidden;
            flex-shrink: 0; transition: transform 0.8s ease;
        }

        .letter-pages { position: relative; width: 100%; height: 100%; }
        .letter-page {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; padding: 0; overflow-y: auto;
            transition: opacity 0.6s ease-in-out, transform 0.6s ease-in-out;
            backface-visibility: hidden;
            /* éšè—æ»šåŠ¨æ¡ä½†å…è®¸æ»šåŠ¨ */
            scrollbar-width: thin;
        }

        /* ç¿»é¡µåŠ¨ç”»ç±» */
        .letter-page.hidden-left { opacity: 0; pointer-events: none; transform: translateX(-30px); }
        .letter-page.hidden-right { opacity: 0; pointer-events: none; transform: translateX(30px); }

        .letter-text { font-family: 'Noto Serif SC', serif; color: #2c3e50; line-height: 2; font-size: 16px; }
        .letter-header { font-family: 'Dancing Script', cursive; font-size: 24px; margin-bottom: 20px; color: #c0392b; }
        .letter-footer { margin-top: 40px; text-align: right; font-family: 'Dancing Script', cursive; font-size: 20px; color: #7f8c8d; }
        
        .page-nav {
            position: absolute; top: 50%; transform: translateY(-50%);
            width: 30px; height: 30px; background: rgba(0,0,0,0.1); border-radius: 50%;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
            font-size: 18px; color: #555; z-index: 100; transition: all 0.2s;
        }
        .page-nav:hover { background: var(--highlight-color); color: #fff; }
        .page-nav.left { left: 10px; }
        .page-nav.right { right: 10px; }
        .page-nav.disabled { opacity: 0; pointer-events: none; }

        /* --- å”±ç‰‡æœº --- */
        .jukebox {
            width: 0; height: 340px; background: #fff; border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2), inset 0 0 20px rgba(0,0,0,0.05);
            position: relative; padding: 0; display: flex; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; overflow: hidden; transform: scale(0.8);
            transition: all 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            border: 3px solid #ddd;
        }
        .jukebox.visible { width: 320px; padding: 25px; opacity: 1; transform: scale(1); margin-left: 0; }
        .jukebox-title { color: #333; font-size: 16px; margin-bottom: 15px; font-family: 'Playfair Display', serif; text-align: center; white-space: nowrap; text-shadow: none; }
        
        .turntable { width: 220px; height: 220px; background: linear-gradient(145deg, #3a4b5c, #233140); border-radius: 50%; position: relative; box-shadow: inset 0 0 15px rgba(0,0,0,0.8), 0 5px 10px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; flex-shrink: 0; border: 5px solid #1a2530; }
        .vinyl { width: 190px; height: 190px; background: repeating-radial-gradient(circle at center, #1a1a1a 0, #1a1a1a 2px, #2c2c2c 3px, #1a1a1a 4px); border-radius: 50%; position: relative; box-shadow: 0 0 10px rgba(0,0,0,0.8); }
        .vinyl.playing { animation: spin 3s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .center-label { width: 60px; height: 60px; background: linear-gradient(45deg, var(--highlight-color), #c0392b); border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border: 4px solid #fff; box-shadow: inset 0 0 10px rgba(0,0,0,0.3); }
        
        .tonearm { position: absolute; top: -10px; right: -10px; width: 180px; height: 100px; transform-origin: 155px 35px; transition: transform 1s ease-in-out; z-index: 20; pointer-events: none; transform: rotate(15deg); }
        .tonearm.playing { transform: rotate(-35deg); }
        .arm-base { position: absolute; top: 20px; right: 10px; width: 30px; height: 30px; background: linear-gradient(145deg, var(--metal-color), #7f8c8d); border-radius: 50%; box-shadow: 0 3px 6px rgba(0,0,0,0.4); border: 2px solid #5f6c7d; }
        .arm-rod { position: absolute; top: 32px; right: 25px; width: 130px; height: 6px; background: linear-gradient(to right, var(--metal-color), #bdc3c7 50%, #95a5a6); transform: rotate(15deg); transform-origin: right center; border-radius: 3px; box-shadow: 0 2px 4px rgba(0,0,0,0.3); }
        .counterweight { position: absolute; top: 30px; right: -5px; width: 25px; height: 12px; background: linear-gradient(to right, #7f8c8d, var(--metal-color)); border-radius: 6px; transform: rotate(15deg); box-shadow: 0 2px 3px rgba(0,0,0,0.3); }
        .cartridge { position: absolute; top: -3px; left: -12px; width: 20px; height: 14px; background: var(--highlight-color); border-radius: 2px; box-shadow: 0 1px 3px rgba(0,0,0,0.3); transform: rotate(-5deg); }
        .cartridge::before { content: ''; position: absolute; bottom: -4px; left: 6px; width: 4px; height: 6px; background: #fff; border-radius: 0 0 2px 2px; }
        
        .play-btn { margin-top: 25px; width: 65px; height: 65px; background: linear-gradient(145deg, var(--highlight-color), #c0392b); border-radius: 50%; border: none; cursor: pointer; color: #fff; font-size: 28px; transition: all 0.3s ease; box-shadow: 0 6px 10px rgba(0,0,0,0.4), inset 0 2px 3px rgba(255,255,255,0.2); flex-shrink: 0; display: flex; align-items: center; justify-content: center; }
        .play-btn:hover { background: linear-gradient(145deg, #ff6b6b, #e74c3c); transform: scale(1.08); box-shadow: 0 8px 15px rgba(0,0,0,0.5), inset 0 2px 3px rgba(255,255,255,0.3); }
        .play-btn:active { transform: scale(0.95); box-shadow: 0 3px 6px rgba(0,0,0,0.4), inset 0 1px 2px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <div class="bg-slideshow" id="bgSlideshow"></div>
    <div class="overlay"></div>

    <!-- 1. ä¿¡å°åœºæ™¯ -->
    <div class="scene" id="scene">
        <div class="card-face front">
            <div class="air-mail-border"></div>
            <div class="front-content">
                <div class="stamp"><img id="stamp-img" src="" alt="Stamp"></div>
                <div class="postmark">NINGBO<br>2024.11.22</div>
                <div class="address-from">
                    <span style="font-weight:bold; color:#000;">Xiaoshu Bao</span><br>
                    Building 15<br>University of Nottingham Ningbo<br>Yinzhou, Ningbo, Zhejiang<br>P.R. China, 315000
                </div>
                <div class="address-to">
                    <span class="label-to">TO:</span>
                    <span style="font-size: 28px; font-weight: bold; color: #000;">Qiaoqiao Bao</span><br>
                    FLAT 66, Mason Halls<br>Edgbaston Park Road<br>Birmingham, UK, B15 2RQ
                </div>
                <div class="flip-hint">ç‚¹å‡»ä¿¡å°ç¿»è½¬ (Click to flip)</div>
            </div>
        </div>

        <div class="card-face back">
            <div class="letter-preview"></div>
            <div class="flap-left"></div>
            <div class="flap-right"></div>
            <div class="flap-bottom"></div>
            <div class="flap-top" id="flapTop"></div>
            <div class="seal" id="sealBtn">Love</div>
            <div class="timer-tip" id="timerText">ç­‰å¾…é€è¾¾...</div>
        </div>
    </div>
    
    <!-- 2. é˜…è¯»åœºæ™¯ -->
    <div class="reading-view-wrapper" id="readingViewWrapper">
        
        <!-- ä¿¡çº¸ -->
        <div class="letter-content" id="letterPaper">
            <div class="letter-pages">
                
                <!-- ç¬¬ä¸€é¡µ -->
                <div class="letter-page page-1" id="page1">
                    <div class="letter-header">Dear å£³å£³åŒ…ï¼Œ(1/3)</div>
                    <!-- ğŸ’Œ ç¬¬ä¸€é¡µå†…å®¹ ğŸ’Œ -->
                    <p class="letter-text">
                        ä½ å¥½å°å¯¿æ˜Ÿå£³å£³åŒ…ã€‚ç”Ÿæ—¥å¿«ä¹å“¦ï¼<br><br>
                        å½“ä½ æ‹†å¼€è¿™å°ä¿¡çš„æ—¶å€™ï¼Œè™½ç„¶ä¸èƒ½åœ¨ä½ èº«è¾¹ï¼Œä½†æˆ‘æŠŠæ‰€æœ‰çš„æ€å¿µéƒ½æŠ˜è¿›äº†è¿™ä¸ªä¿¡å°é‡Œã€‚<br><br>
                        ä»Šå¤©æ˜¯11.22ï¼Œå·²ç»å’Œä½ å·²ç»åˆ†åˆ«äº†2ä¸ªæœˆäº†ã€‚å¥½æƒ³ä½ ï¼æƒ³ä½ æƒ³çš„è¦æ­»äº†ã€‚åæ­£å°±æ˜¯å¾ˆæƒ³ã€‚æœ€è¿‘å¥½å¿™å¥½ç´¯ï¼Œä½†æ˜¯æœ€å¤§æœ€å¼€å¿ƒçš„åŠ¨åŠ›å°±æ˜¯ä½ é©¬ä¸Šè¦å›æ¥äº†ã€‚<br><br>
                        å°è–¯åŒ…æœ‰å¥½å¤šå¥½å¤šå¥½ç©çš„å¥½åƒçš„äº‹æƒ…å’Œåœ°æ–¹æƒ³å’Œä½ ä¸€èµ·å»ã€‚æƒ³å’Œä½ ä¸€èµ·ç‰µæ‰‹åœ¨å¤œæ™šåˆ°æœ‰æ°´çš„åœ°æ–¹å‹é©¬è·¯ï¼Œæƒ³è½½ç€ä½ ä¸€èµ·æˆ´ç€æˆ‘ä»¬èŒèŒçš„å¤´ç›”è¯´ç€èŒèŒçš„å‚»è¯é©¶è¿‡å¤§è¡—å°å··ï¼Œæƒ³ä¸€å¹´çš„å…¶ä»–å­£èŠ‚é‡Œä¸€èµ·å»æ—¥æœ¬ç©ï¼Œæƒ³ä¸ºå£³å£³åŒ…å’Œå°è–¯åŒ…çš„çˆ±æƒ…æ•…äº‹å†™æ­Œï¼Œæƒ³ä¸€ç›´é™ªåœ¨ä½ èº«è¾¹åšä½ çš„å‡ºæ°”ç­’å…¼è´´èº«ä¾å«ã€‚å’Œä½ åœ¨ä¸€èµ·æ¯å¤©éƒ½ä¼šå¼€å¿ƒçš„ï¼æœ€è¿‘å‡ å¹´ä¹Ÿæ€»ä¼šå¿™å¿™çš„è‚¯å®šä¼šæœ‰åˆ†åˆ«ï¼Œä½†æ˜¯æ— è®ºæˆ‘èº«å¤„ä½•æ–¹ï¼Œæ— è®ºæˆ‘åœ¨å¹²ä»€ä¹ˆï¼Œå¿ƒä¸­æ€»ä¼šæœ‰å£³å£³åŒ…ï¼Œæ€»ä¼šæƒ³ç€å£³å£³åŒ…ï¼Œæ€»ä¼šæƒ³ç€é€—ä½ å¼€å¿ƒã€‚ä»¥åçš„ä»¥åè¿˜æœ‰å¥½å¤šå¥½å¤šçº¦å®šï¼Œç¯æ¸¸ä¸–ç•Œï¼Œåœ¨ä¸€ä¸ªèˆ’é€‚çš„åœ°æ–¹å®šå±…ï¼Œä¸€èµ·è£…ä¿®æˆ‘ä»¬çš„å°å®¶ï¼Œå…»ä¸€åªå°çŒ«ï¼Œä¸€ç›´é™ªä¼´å®ˆæŠ¤åœ¨ä½ èº«è¾¹ï¼Œå¬ç€ä½ å’Œæˆ‘è¯´çš„è¯ã€‚<br><br>
                        æœ€è¿‘æ—¶é—´å¾ˆå¿™å¾ˆç´¯å•¦â€¦å‰ä¸€æ®µæ—¶é—´ä¹Ÿæœ‰ç‚¹å‘è„¾æ°”å’Œå£³å£³åŒ…å¤§åµè¿‡å‡ æ¶ï¼Œé”™äº†å–µã€‚ä½†æ˜¯æˆ‘ä¸€ç›´çˆ±ç€ä½ çš„å“¦ã€‚ä¸è¦å¤§åµã€‚å£³å£³åŒ…ä¼šä¼¤å¿ƒçš„ã€‚å°±ç®—æˆ‘ä»¬åˆ†éš”å¼‚å›½å“¼å“¼é‚£ä¹Ÿä¸åº”è¯¥æŠµå¾—ä½å£³å£³åŒ…å’Œå°è–¯åŒ…çš„ç¾ç»Šï¼å¼‚å›½å°±å¼‚å›½ï¼Œä»¥åè¯´ä¸å®šè¿˜æœ‰è¿™æ ·å‘¢ï¼Œåæ­£æˆ‘å°±çˆ±å£³å£³åŒ…ï¼Œå°±ç®—æˆ‘èµ°åˆ°ä¸–ç•Œçš„å°½å¤´ä¹Ÿä¸ä¼šæ”¹å˜ã€‚å£³å£³åŒ…å’Œæˆ‘æ‹‰è¿‡å‹¾çš„ï¼Œæˆ‘æ°¸è¿œè®°ç€çš„ã€‚
                    </p>
                    <div class="letter-footer">Love,<br>å°è–¯åŒ…</div>
                </div>
                
                <!-- ç¬¬äºŒé¡µ -->
                <div class="letter-page page-2 hidden-right" id="page2">
                    <div class="letter-header">To å£³å£³åŒ… (2/3)</div>
                    <!-- ğŸµ ç¬¬äºŒé¡µå†…å®¹ ğŸµ -->
                    <p class="letter-text">
                        <b>äºæ˜¯å¥³å­©æ‚„æ‚„åœ°é—®ï¼šé‚£çˆ±ä¼šæ°¸æ’å—ï¼Ÿ</b><br><br>
                        <b>ç”·å­©å¥½ä¼¼åˆä¸èƒ½ç¡®å®šå›ç­”ï¼Œäºæ˜¯æ‚„æ‚„åœ°æ‹¿èµ·å½•éŸ³æœºå½•ä¸‹ä¸€æ®µæ®µè¯è¯­ã€‚</b><br><br>
                        <b>ç”·å­©é€ç»™å¥³å­©ä¸€ä¸ªå”±ç‰‡æœºï¼Œå¥¹è½»è½»æŒ‰ä¸‹ã€Œæ’­æ”¾ã€é”®ï¼Œé‡Œé¢ä¼ å‡ºçš„æ˜¯ä»–ä»¬æœªæ¥çš„å£°éŸ³ã€‚</b><br><br>
                        å‘ƒå‘ƒè™½ç„¶ä¹°çš„æœ‰ç‚¹è´µé¢ä½†æ˜¯ä»¥åè¦æ˜¯å°è–¯åŒ…è¿‡ç”Ÿæ—¥å£³å£³åŒ…ä¸è¦å›è´µå•¦ã€‚åªæ˜¯å› ä¸ºæ­£å¥½æƒ³é€å®ƒä½†æ˜¯å”±ç‰‡æœºéƒ½ä¸ä¾¿å®œâ€¦<br>
                        é‚£ä¹ˆå°±ç¥ç¦æˆ‘ä»¬çš„å°å¯¿æ˜Ÿå£³å£³åŒ…ç”Ÿæ—¥å¿«ä¹ï¼Œèº«ä½“å¥åº·ï¼Œå£³å£³åŒ…åœ¨è‹±å›½ä¸€ä¸ªäººä¹Ÿè¦æ¯å¤©å¼€å¿ƒã€‚
                    </p>
                    <div class="letter-footer">çˆ±ä½ çš„å°è–¯åŒ…<br>2025å¹´11æœˆ22æ—¥</div>
                </div>

                <!-- ç¬¬ä¸‰é¡µ (æ­Œè¯é¡µ) -->
                <div class="letter-page page-3 hidden-right" id="page3">
                    <div class="letter-header">èŠ±æ³¥æ£’ï¼ˆã¯ãªã¨ã‚™ã‚ã»ã‚™ã†ï¼‰</div>
                    <!-- ğŸµ æ­Œè¯ ğŸµ -->
                    <div class="letter-text" style="font-size: 14px; line-height: 1.8;">
                        <p>
                            <strong>Verse A</strong><br>
                            æµ·è¾ºï¼ˆã†ã¿ã¹ï¼‰ã®é¢¨ï¼ˆã‹ãœï¼‰ã« ä¹±ï¼ˆã¿ã ï¼‰ã‚ŒãŸ<br>
                            umibe no kaze ni midareta<br>
                            æµ·è¾¹çš„é£å¹ä¹±äº†<br><br>
                            äºŒäººï¼ˆãµãŸã‚Šï¼‰ã§æ›¸ï¼ˆã‹ï¼‰ã„ãŸ ç‰©èªï¼ˆã‚‚ã®ãŒãŸã‚Šï¼‰<br>
                            futari de kaita monogatari<br>
                            æˆ‘ä»¬å·å·å†™ä¸‹çš„ç«¥è¯<br><br>
                            å›ï¼ˆãã¿ï¼‰ã¯ç¬‘ï¼ˆã‚ã‚‰ï¼‰ã£ã¦ ä¸–ç•Œï¼ˆã›ã‹ã„ï¼‰ã‚’<br>
                            kimi wa waratte sekai o<br>
                            ä½ ç¬‘ç€è¯´è¦æŠŠä¸–ç•Œ<br><br>
                            å°ï¼ˆã¡ã„ï¼‰ã•ãªãƒã‚±ãƒƒãƒˆã« é€£ï¼ˆã¤ï¼‰ã‚Œã¦ã‚†ã“ã†<br>
                            chiisana poketto ni tsurete yukÅ<br>
                            è£…è¿›å°å°å£è¢‹å¸¦å›å®¶<br><br>

                            <strong>Pre-Chorus</strong><br>
                            ã€ŒèŠ±ï¼ˆã¯ãªï¼‰ã¯æ¯ï¼ˆã‹ï¼‰ã‚Œã‚‹ã€äººï¼ˆã²ã¨ï¼‰ã¯é›¢ï¼ˆã¯ãªï¼‰ã‚Œã‚‹ã€<br>
                            hana wa kareru, hito wa hanareru<br>
                            ã€ŒèŠ±ä¼šè°¢ï¼Œäººä¼šæ•£ã€<br><br>
                            åƒ•ï¼ˆã¼ãï¼‰ã¯ã€Œã¾ãŸæ˜¥ï¼ˆã¯ã‚‹ï¼‰ãŒæ¥ï¼ˆãï¼‰ã‚‹ã€<br>
                            boku wa â€œmata haru ga kuruâ€<br>
                            æˆ‘è¯´ã€Œé‚£å°±ç­‰åˆ°æ˜¥å¤©ã€<br><br>
                            ã€Œç´„æŸï¼ˆã‚„ãããï¼‰ã¯é¢¨ï¼ˆã‹ãœï¼‰ã®ã‚ˆã†ã€<br>
                            yakusoku wa kaze no yÅ<br>
                            ã€Œæ‰¿è¯ºå•Šï¼Œå¦‚é£ä¸€èˆ¬ã€<br><br>
                            ã€Œå˜˜ï¼ˆã†ãï¼‰ã€ã‚’å®ç‰©ï¼ˆãŸã‹ã‚‰ã‚‚ã®ï¼‰ã«ã™ã‚‹<br>
                            uso o takaramono ni shiyÅ<br>
                            é‚£å°±æŠŠã€Œè°è¨€ã€ä¸€ç›´çè—å§<br><br>

                            <strong>Chorus A</strong><br>
                            èŠ±ï¼ˆã¯ãªï¼‰ã‚’ç›—ï¼ˆã¬ã™ï¼‰ã¿ã«è¡Œï¼ˆã„ï¼‰ã“ã†<br>
                            hana o nusumi ni ikÅ<br>
                            æˆ‘ä»¬å»å·èŠ±å§<br><br>
                            æ˜¥ï¼ˆã¯ã‚‹ï¼‰ãŒæ°—ï¼ˆãï¼‰ã¥ãå‰ï¼ˆã¾ãˆï¼‰ã« é¢¨ï¼ˆã‹ãœï¼‰ãŒæ­Œï¼ˆã†ãŸï¼‰ã†é–“ï¼ˆã‚ã„ã ï¼‰ã«<br>
                            haru ga kizuku mae ni kaze ga utau aida ni<br>
                            è¶æ˜¥å¤©è¿˜æ²¡å‘ç°ï¼Œè¶é£è¿˜åœ¨å”±<br><br>
                            ãƒ©ãƒ©ãƒ©â€”â€” ä¸–ç•Œï¼ˆã›ã‹ã„ï¼‰ãŒå´©ï¼ˆããšï¼‰ã‚Œã¦ã‚‚<br>
                            rarara â€” sekai ga kuzurete mo<br>
                            å•¦å•¦å•¦â€”â€”å°±ç®—ä¸–ç•Œå´©å¡Œ<br><br>
                            å›ï¼ˆãã¿ï¼‰ã¨èŠ±ï¼ˆã¯ãªï¼‰ã§çœ ï¼ˆã­ã‚€ï¼‰ã‚ŠãŸã„ã®<br>
                            kimi to hana de nemuritai no<br>
                            æˆ‘ä¹Ÿæƒ³å’Œä½ åœ¨èŠ±ä¸›ä¸­æ²‰æ²‰ç¡å»<br><br>

                            <strong>Verse B</strong><br>
                            é›¨ï¼ˆã‚ã‚ï¼‰ãŒè½ï¼ˆãŠï¼‰ã¡ãŸæ—¥ï¼ˆã²ï¼‰ã«<br>
                            ame ga ochita hi ni<br>
                            åæ¥é›¨è½ä¸‹æ—¶<br><br>
                            å½±ï¼ˆã‹ã’ï¼‰ã‚’é‡ï¼ˆã‹ã•ï¼‰ã­ã¦ æƒ³ï¼ˆãŠã‚‚ï¼‰ã„ã‚’çµï¼ˆã‚€ã™ï¼‰ã‚“ã <br>
                            kage o kasanete omoi o musunda<br>
                            æˆ‘ä»¬æŠŠå½±å­å æˆç‰µæŒ‚<br><br>
                            ãŸã¨ãˆä¸–ç•Œï¼ˆã›ã‹ã„ï¼‰ãŒé…ï¼ˆãŠãï¼‰ã‚Œã¦ã‚‚<br>
                            tatoe sekai ga okurete mo<br>
                            å°±ç®—å…¨ä¸–ç•Œéƒ½è¿Ÿåˆ°<br><br>
                            åƒ•ï¼ˆã¼ãï¼‰ã¯å›ï¼ˆãã¿ï¼‰ã‚’å…ˆï¼ˆã•ãï¼‰ã«å¾…ï¼ˆã¾ï¼‰ã¤ã‚ˆ<br>
                            boku wa kimi o saki ni matsu yo<br>
                            æˆ‘ä¹Ÿä¼šå…ˆæ¥ç­‰ä½ å•Š<br><br>

                            <strong>Chorus B</strong><br>
                            èŠ±ï¼ˆã¯ãªï¼‰ã‚’ç›—ï¼ˆã¬ã™ï¼‰ã¿ã«è¡Œï¼ˆã„ï¼‰ã“ã†<br>
                            hana o nusumi ni ikÅ<br>
                            æˆ‘ä»¬å»å·èŠ±å§<br><br>
                            èŠ±ï¼ˆã¯ãªï¼‰ãŒæ¯ï¼ˆã‹ï¼‰ã‚Œã‚‹å‰ï¼ˆã¾ãˆï¼‰ã« åƒ•ï¼ˆã¼ãï¼‰ãŒè¿·ï¼ˆã¾ã‚ˆï¼‰ã†å‰ï¼ˆã¾ãˆï¼‰ã«<br>
                            hana ga kareru mae ni boku ga mayou mae ni<br>
                            è¶èŠ±è¿˜æ²¡æ¯ï¼Œè¶æˆ‘è¿˜å‚»<br><br>
                            ãƒ©ãƒ©ãƒ©â€”â€” æœ€å¾Œï¼ˆã•ã„ã”ï¼‰ã«æ®‹ï¼ˆã®ã“ï¼‰ã£ã¦ã‚‚<br>
                            rarara â€” saigo ni nokotte mo<br>
                            å•¦å•¦å•¦â€”â€”å°±ç®—æœ€ååªå‰©ä¸‹<br><br>
                            å¤¢ï¼ˆã‚†ã‚ï¼‰ã®ã“ã ã¾ã§ã„ã„ã‚ˆ<br>
                            yume no kodama de ii yo<br>
                            æ¢¦çš„å›å“ä¹Ÿè¶³å¤Ÿ<br><br>

                            <strong>Final Chorus</strong><br>
                            ã‚â€”â€” ã‚‚ã†ä¸€åº¦ï¼ˆã„ã¡ã©ï¼‰ èŠ±ï¼ˆã¯ãªï¼‰ã‚’ç›—ï¼ˆã¬ã™ï¼‰ã‚‚ã†<br>
                            a â€” mÅ ichido hana o nusumÅ<br>
                            å•Šâ€”â€”å†ä¸€æ¬¡å»å·èŠ±å§<br><br>
                            è£¸è¶³ï¼ˆã¯ã ã—ï¼‰ã§æµ·è¾ºï¼ˆã†ã¿ã¹ï¼‰ã‚’é§†ï¼ˆã‹ï¼‰ã‘ã¦ã„ã“ã†<br>
                            hadashi de umibe o kakete ikÅ<br>
                            è®©æˆ‘ä»¬èµ¤è„šè·‘è¿‡æµ·è¾¹çš„å°½å¤´<br><br>
                            èŠ±ï¼ˆã¯ãªï¼‰ã‚’ã²ã¨ã¤æŠ±ï¼ˆã ï¼‰ãã—ã‚ã¦ã‚ˆ<br>
                            hana o hitotsu dakishimete yo<br>
                            å°†èŠ±ä¸€æŠŠæ‘˜ä¸‹å§<br><br>

                            <strong>Outro</strong><br>
                            ã€Œã­ã‡è¦‹ï¼ˆã¿ï¼‰ã¦ã€æ˜¥ï¼ˆã¯ã‚‹ï¼‰ãŒæ¥ï¼ˆãï¼‰ãŸã‚ˆã€<br>
                            nee mite, haru ga kita yo<br>
                            ã€Œå–‚ä½ çœ‹ï¼Œæ˜¥å¤©æ¥äº†å‘¢ã€‚ã€<br><br>
                            ã€ŒèŠ±ï¼ˆã¯ãªï¼‰ã‚’ç›—ï¼ˆã¬ã™ï¼‰ã¿ã«è¡Œï¼ˆã„ï¼‰ã“ã†ã€<br>
                            hana o nusumi ni ikÅ<br>
                            ã€Œæˆ‘ä»¬å»å·èŠ±å§ã€
                        </p>
                        <br> PS: èŠ±æ³¥æ£’æ˜¯å°å·çš„æ„æ€å“¦
                    </div>
                    <div class="letter-footer">Yours,<br>XSB</div>
                </div>

            </div>
            
            <div class="page-nav right" id="nextPageBtn"><i class="fa-solid fa-arrow-right"></i></div>
            <div class="page-nav left disabled" id="prevPageBtn"><i class="fa-solid fa-arrow-left"></i></div>
        </div>
        
        <!-- å”±ç‰‡æœº (åˆå§‹éšè—) -->
        <div class="jukebox" id="jukeboxModule">
            <h3 class="jukebox-title"><span id="musicTitle">Loading...</span></h3>
            <div class="turntable">
                <div class="vinyl" id="vinylRecord">
                    <div class="center-label"></div>
                </div>
                <div class="tonearm" id="tonearm">
                    <div class="counterweight"></div>
                    <div class="arm-rod"><div class="cartridge"></div></div>
                    <div class="arm-base"></div>
                </div>
            </div>
            <button class="play-btn" id="playBtn"><i class="fa-solid fa-play" id="playIcon"></i></button>
            <audio id="audioPlayer" preload="auto"></audio>
        </div>

    </div>

    <!-- ================= é…ç½®åŒºåŸŸ ================= -->
    <script>
        // âœ¨ TODO: 1. èƒŒæ™¯å›¾
        const bgImages = [
            "image/IMG_2935.jpeg", 
            "image/IMG_5606.jpeg",
            "image/IMG_1578.jpeg",
            "image/1.jpg", "image/2.jpg", "image/3.jpg", "image/4.jpeg",
            "image/5.jpeg",
            "image/6.jpeg",
            "image/7.jpeg",
            "image/8.jpeg",
            "image/9.JPG",
            "image/10.jpg",
            "image/11.jpeg",
        ];
        // âœ¨ TODO: 2. é‚®ç¥¨å›¾
        const stampImageURL = "image/IMG_2589.jpeg"; 
        // âœ¨ TODO: 3. æ—¶é—´
        const targetDateStr = "2025-11-27T00:00:00+08:00"; 
        
        // âœ¨ TODO: 7. éŸ³ä¹ (å·²ä¿®æ”¹ä¸ºä½ çš„æœ¬åœ°æ–‡ä»¶è·¯å¾„)
        const music = {
            url: "image/èŠ±æ³¥æ£’ï¼ˆã¯ãªã¨ã‚™ã‚ã»ã‚™ã†ï¼‰COP.mp3", 
            title: "èŠ±æ³¥æ£’",
            label: "QQB"
        };
        
        // âœ¨ æµ‹è¯•æ¨¡å¼
        const TEST_MODE = true;

        // ================= é€»è¾‘ä»£ç  =================
        const scene = document.getElementById('scene');
        const sealBtn = document.getElementById('sealBtn');
        const timerText = document.getElementById('timerText');
        const bgSlideshow = document.getElementById('bgSlideshow');
        
        const readingViewWrapper = document.getElementById('readingViewWrapper');
        const jukeboxModule = document.getElementById('jukeboxModule');
        const nextPageBtn = document.getElementById('nextPageBtn');
        const prevPageBtn = document.getElementById('prevPageBtn');
        
        const pages = [
            document.getElementById('page1'),
            document.getElementById('page2'),
            document.getElementById('page3')
        ];
        
        const audioPlayer = document.getElementById('audioPlayer');
        const playBtn = document.getElementById('playBtn');
        const playIcon = document.getElementById('playIcon');
        const tonearm = document.getElementById('tonearm');
        const vinylRecord = document.getElementById('vinylRecord');

        // åˆå§‹åŒ–
        document.getElementById('stamp-img').src = stampImageURL;
        audioPlayer.src = music.url;
        document.getElementById('musicTitle').textContent = music.title;

        let isFlipped = false;
        let isOpened = false;
        let currentPage = 1;
        let isPlaying = false;
        const totalPages = 3;

        // èƒŒæ™¯è½®æ’­
        function initBackground() {
            bgImages.forEach((url, index) => {
                const div = document.createElement('div');
                div.className = 'bg-slide';
                div.style.backgroundImage = `url('${url}')`;
                if(index === 0) div.classList.add('active');
                bgSlideshow.appendChild(div);
            });
            let currentSlide = 0;
            if (bgImages.length > 1) {
                setInterval(() => {
                    const slides = document.querySelectorAll('.bg-slide');
                    slides[currentSlide].classList.remove('active');
                    currentSlide = (currentSlide + 1) % slides.length;
                    slides[currentSlide].classList.add('active');
                }, 5000);
            }
        }
        initBackground();

        // ç¿»è½¬é€»è¾‘
        scene.addEventListener('click', (e) => {
            if (isOpened || e.target.closest('#sealBtn')) return;
            isFlipped = !isFlipped;
            scene.classList.toggle('flipped', isFlipped);
        });

        // å€’è®¡æ—¶
        function checkTime() {
            const now = new Date();
            const target = new Date(targetDateStr);
            const diff = target - now;
            if (TEST_MODE || diff <= 0) {
                return { locked: false, text: "ç‚¹å‡»ç«æ¼†å°å¼€å¯ (Open)" };
            } else {
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                return { locked: true, text: `è·ç¦»é€è¾¾è¿˜æœ‰: ${days}å¤© ${hours}æ—¶ ${minutes}åˆ† ${seconds}ç§’` };
            }
        }
        setInterval(() => {
            if (!isOpened) {
                const status = checkTime();
                timerText.innerText = status.text;
                sealBtn.style.cursor = status.locked ? 'not-allowed' : 'pointer';
            }
        }, 1000);

        // å¼€ä¿¡
        sealBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            const status = checkTime();
            if (status.locked) {
                scene.style.animation = "shake 0.5s";
                setTimeout(() => scene.style.animation = "", 500);
                alert("ä¿¡ä»¶è¿˜åœ¨è¿è¾“ä¸­å“¦ï½");
                return;
            }
            isOpened = true;
            scene.classList.add('open'); 
            
            setTimeout(() => {
                scene.classList.add('reading');
            }, 800);
        });

        // ç¿»é¡µä¸å¸ƒå±€åˆ‡æ¢ (æ ¸å¿ƒé€»è¾‘æ›´æ–°)
        function showPage(pageNumber) {
            currentPage = pageNumber;

            // 1. å¤„ç†æ‰€æœ‰é¡µé¢çš„ä½ç½®çŠ¶æ€
            pages.forEach((page, index) => {
                const pageIndex = index + 1; // 1-based index
                // ç§»é™¤æ—§çŠ¶æ€
                page.classList.remove('hidden-left', 'hidden-right');
                
                if (pageIndex < currentPage) {
                    // åœ¨å½“å‰é¡µå·¦è¾¹
                    page.classList.add('hidden-left');
                } else if (pageIndex > currentPage) {
                    // åœ¨å½“å‰é¡µå³è¾¹
                    page.classList.add('hidden-right');
                } else {
                    // å½“å‰é¡µæ˜¾ç¤º (æ—  hidden class)
                }
            });

            // 2. æŒ‰é’®çŠ¶æ€
            prevPageBtn.classList.toggle('disabled', currentPage === 1);
            nextPageBtn.classList.toggle('disabled', currentPage === totalPages);

            // 3. å”±ç‰‡æœºæ˜¾ç¤ºé€»è¾‘
            if (currentPage === 1) {
                // ç¬¬ä¸€é¡µéšè—å”±ç‰‡æœº
                jukeboxModule.classList.remove('visible');
                readingViewWrapper.classList.remove('show-jukebox');
            } else {
                // ç¬¬äºŒé¡µå’Œç¬¬ä¸‰é¡µéƒ½æ˜¾ç¤ºå”±ç‰‡æœº
                jukeboxModule.classList.add('visible');
                readingViewWrapper.classList.add('show-jukebox');
            }
        }

        nextPageBtn.addEventListener('click', () => {
            if (currentPage < totalPages) showPage(currentPage + 1);
        });
        prevPageBtn.addEventListener('click', () => {
            if (currentPage > 1) showPage(currentPage - 1);
        });
        
        // éŸ³ä¹æ§åˆ¶
        playBtn.addEventListener('click', () => {
            if (isPlaying) {
                audioPlayer.pause();
                tonearm.classList.remove('playing');
                vinylRecord.classList.remove('playing');
                playIcon.className = 'fa-solid fa-play';
                isPlaying = false;
            } else {
                tonearm.classList.add('playing');
                vinylRecord.classList.add('playing');
                setTimeout(() => {
                    audioPlayer.play().catch(e => {
                        console.error(e);
                        alert("æ’­æ”¾å¤±è´¥ï¼Œå¯èƒ½æ˜¯æµè§ˆå™¨é™åˆ¶æˆ–æ–‡ä»¶è·¯å¾„é”™è¯¯ã€‚è¯·æ£€æŸ¥éŸ³é¢‘æ–‡ä»¶æ˜¯å¦åœ¨ image æ–‡ä»¶å¤¹ä¸‹ã€‚");
                        tonearm.classList.remove('playing');
                        vinylRecord.classList.remove('playing');
                    });
                }, 500);
                playIcon.className = 'fa-solid fa-pause';
                isPlaying = true;
            }
        });
        audioPlayer.addEventListener('ended', () => {
            tonearm.classList.remove('playing');
            vinylRecord.classList.remove('playing');
            playIcon.className = 'fa-solid fa-play';
            isPlaying = false;
        });
    </script>
</body>
</html>